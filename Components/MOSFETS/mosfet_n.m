function out = mosfet_n(u_g,u_d,u_s,u_t,K_1)
% ------------------------------------------------------------------------------
% MOSFET function, idealised
%
% Copyright 2021 Marcus Bannenberg (BUW, bannenberg@uni-wuppertal.de)
% ------------------------------------------------------------------------------
% OUTPUT
% ------------------------------------------------------------------------------
% out  <double> : I_DS.
% ------------------------------------------------------------------------------
% REQUIRED INPUT
% ------------------------------------------------------------------------------
% u_g  <double> : Voltage at the gate.
% u_d  <double> : Voltage at the drain.
% u_s  <double> : Voltage at the source.
% u_t  <double> : Threshold voltage.
% ------------------------------------------------------------------------------
% OPTIONAL INPUT
% ------------------------------------------------------------------------------
% K  <double> : Stiffnes multiplier.
% ------------------------------------------------------------------------------
    if (nargin < 5)
        K_1 = 1e-6;
    end
   
    out = K_1*(max((u_g - u_s - u_t),0).^2 - max((u_g-u_d-u_t),0).^2);

end